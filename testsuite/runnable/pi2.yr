
    
extern (C) printf (const c : p!(char), ...)-> i32;
extern (C) sscanf (const x : p!(char), const y : p!char, ...)-> i32;
extern (C) time (x : p!u64)-> i32;

def sum (a : [f64]) {
    let total = 0.;
    for it in 0U .. a.len {
        total = total + a [it];
    }
    return total;
}

def map (n : u32) {
    let array = [f64 ; n];
    for i in 0U .. array.len {
        array [i] = (4.0 / n) / (1. + ((i - 0.5) * (1. / n)) * ((i - 0.5) * (1. / n)));
    }
    return array;
}

def main (args) {
    let start = 0UL, end = 0UL;
    let q = 1U;
    if (args.len == 2) 
        sscanf (args [1].ptr, "%d".ptr, &q);
    
    time (&start);
    let pi = map (q).sum ();
    time (&end);
    
    printf ("Pi = %.18f : (%d)\n".ptr, pi, end - start);    
}
